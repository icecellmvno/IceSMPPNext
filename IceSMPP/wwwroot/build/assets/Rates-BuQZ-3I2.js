import{r as f,m as F,j as e,S as q}from"./App-CmqUjaN5.js";import{B as s}from"./button-P3a7UsiS.js";import{I as v}from"./input-BNaBDwi7.js";import{L as r}from"./label-BEB_8ICF.js";import{T}from"./textarea-CYa3ItW1.js";import{S as G}from"./switch-C-_rdssw.js";import{B as J}from"./badge-kuerOQjQ.js";import{c as A}from"./constants-vpztXBkd.js";import{C as K,a as Q,b as V,c as W,d as Y}from"./card-W6xDAvb4.js";import{D as y,a as C,b as R,c as b,d as N,e as D}from"./dialog-dFOvoa_K.js";import{T as Z,a as ee,b as k,c as d,d as te,e as o}from"./table-D_1QihfK.js";import"./select-BwHXfXYN.js";import{P as se}from"./plus-CG7YYuFa.js";import"./index-cPx927kp.js";import"./index-CoAmXZ53.js";import"./index-CgeA6eXF.js";import"./index-BJ4xYr-b.js";import"./index-8L4t-OO9.js";import"./createLucideIcon-DiUTaDX6.js";import"./Combination-DIdNSm4m.js";import"./index-MP6m9tZ7.js";import"./index-CZ-wKduk.js";function De({customer:x}){var E;const[_,h]=f.useState(!1),[P,m]=f.useState(!1),[S,w]=f.useState(null),[g,u]=f.useState(null),{data:p,setData:j,post:$,processing:B,errors:a,reset:I}=F({prefix:"",rate:"",currency:"XAF",notes:""}),{data:l,setData:c,put:M,processing:H,errors:i,reset:L}=F({prefix:"",rate:"",currency:"XAF",is_active:!0,notes:""}),O=t=>{t.preventDefault(),$(route("customers.rates.store",x),{onSuccess:()=>{h(!1),I()}})},z=t=>{t.preventDefault(),S&&M(route("customers.rates.update",[x,S]),{onSuccess:()=>{m(!1),w(null),L()}})},U=t=>{w(t),c({prefix:t.prefix||"",rate:t.rate,currency:t.currency,is_active:t.is_active,notes:t.notes||""}),m(!0)},X=()=>{g&&q.delete(route("customers.rates.destroy",[x,g]),{onSuccess:()=>{u(null)}})};return e.jsxs(e.Fragment,{children:[e.jsxs(K,{children:[e.jsx(Q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(V,{children:"SMS Rates"}),e.jsx(W,{children:"Manage SMS rates for this customer"})]}),e.jsxs(s,{onClick:()=>h(!0),children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Add Rate"]})]})}),e.jsx(Y,{children:e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(k,{children:[e.jsx(d,{children:"Prefix"}),e.jsx(d,{children:"Rate"}),e.jsx(d,{children:"Currency"}),e.jsx(d,{children:"Status"}),e.jsx(d,{children:"Actions"})]})}),e.jsx(te,{children:(E=x.rates)==null?void 0:E.map(t=>e.jsxs(k,{children:[e.jsx(o,{className:"font-medium",children:t.prefix||"Any"}),e.jsx(o,{children:t.rate}),e.jsx(o,{children:t.currency}),e.jsx(o,{children:e.jsx(J,{variant:t.is_active?"success":"secondary",children:t.is_active?"Active":"Inactive"})}),e.jsx(o,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s,{variant:"outline",size:"sm",onClick:()=>U(t),children:"Edit"}),e.jsx(s,{variant:"destructive",size:"sm",onClick:()=>u(t.id),children:"Delete"})]})})]},t.id))})]})})]}),e.jsx(y,{open:!!g,onOpenChange:t=>!t&&u(null),children:e.jsxs(C,{children:[e.jsxs(R,{children:[e.jsx(b,{children:"Delete Rate"}),e.jsx(N,{children:"Are you sure you want to delete this rate? This action cannot be undone."})]}),e.jsxs(D,{children:[e.jsx(s,{variant:"outline",onClick:()=>u(null),children:"Cancel"}),e.jsx(s,{variant:"destructive",onClick:X,children:"Delete"})]})]})}),e.jsx(y,{open:_,onOpenChange:t=>!t&&h(!1),children:e.jsxs(C,{children:[e.jsxs(R,{children:[e.jsx(b,{children:"Add New Rate"}),e.jsx(N,{children:"Add a new SMS rate for this customer."})]}),e.jsxs("form",{onSubmit:O,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"prefix",children:"Prefix Pattern"}),e.jsx(v,{id:"prefix",value:p.prefix,onChange:t=>j("prefix",t.target.value),placeholder:"e.g. ^90[0-9]{10}$"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Regular expression pattern for matching phone numbers. Leave empty to match all numbers."}),a.prefix&&e.jsx("p",{className:"text-sm text-destructive",children:a.prefix})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"rate",children:"Rate"}),e.jsx(v,{id:"rate",type:"text",pattern:"^\\d*[,.]?\\d{0,5}$",value:p.rate,onChange:t=>{const n=t.target.value.replace(".",",");(n===""||/^\d*[,]?\d{0,5}$/.test(n))&&j("rate",n)},placeholder:"18,5"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter rate with comma separator (e.g. 18,5)"}),a.rate&&e.jsx("p",{className:"text-sm text-destructive",children:a.rate})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"currency",children:"Currency"}),e.jsx("select",{id:"currency",className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50",value:p.currency,onChange:t=>j("currency",t.target.value),children:A.map(t=>e.jsxs("option",{value:t.code,children:[t.name," (",t.code,")"]},t.code))}),a.currency&&e.jsx("p",{className:"text-sm text-destructive",children:a.currency})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"notes",children:"Notes"}),e.jsx(T,{id:"notes",value:p.notes,onChange:t=>j("notes",t.target.value)}),a.notes&&e.jsx("p",{className:"text-sm text-destructive",children:a.notes})]}),e.jsxs(D,{children:[e.jsx(s,{type:"button",variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(s,{type:"submit",disabled:B,children:"Add Rate"})]})]})]})}),e.jsx(y,{open:P,onOpenChange:t=>!t&&m(!1),children:e.jsxs(C,{children:[e.jsxs(R,{children:[e.jsx(b,{children:"Edit Rate"}),e.jsx(N,{children:"Update the SMS rate details."})]}),e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-prefix",children:"Prefix Pattern"}),e.jsx(v,{id:"edit-prefix",value:l.prefix,onChange:t=>c("prefix",t.target.value),placeholder:"e.g. ^90[0-9]{10}$"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Regular expression pattern for matching phone numbers. Leave empty to match all numbers."}),i.prefix&&e.jsx("p",{className:"text-sm text-destructive",children:i.prefix})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-rate",children:"Rate"}),e.jsx(v,{id:"edit-rate",type:"text",pattern:"^\\d*[,.]?\\d{0,5}$",value:l.rate,onChange:t=>{const n=t.target.value.replace(".",",");(n===""||/^\d*[,]?\d{0,5}$/.test(n))&&c("rate",n)},placeholder:"18,5"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter rate with comma separator (e.g. 18,5)"}),i.rate&&e.jsx("p",{className:"text-sm text-destructive",children:i.rate})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-currency",children:"Currency"}),e.jsx("select",{id:"edit-currency",className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50",value:l.currency,onChange:t=>c("currency",t.target.value),children:A.map(t=>e.jsxs("option",{value:t.code,children:[t.name," (",t.code,")"]},t.code))}),i.currency&&e.jsx("p",{className:"text-sm text-destructive",children:i.currency})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{id:"edit-is_active",checked:l.is_active,onCheckedChange:t=>c("is_active",t)}),e.jsx(r,{htmlFor:"edit-is_active",children:"Active"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-notes",children:"Notes"}),e.jsx(T,{id:"edit-notes",value:l.notes,onChange:t=>c("notes",t.target.value)}),i.notes&&e.jsx("p",{className:"text-sm text-destructive",children:i.notes})]}),e.jsxs(D,{children:[e.jsx(s,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(s,{type:"submit",disabled:H,children:"Update Rate"})]})]})]})})]})}export{De as default};
