import{r as C,m as V,j as e}from"./App-RCZf4Oj7.js";import{B as a}from"./button-c9ic-fOB.js";import{I as l}from"./input-BzAsFOCX.js";import{L as n}from"./label-BK41ekJv.js";import{B as E}from"./badge-VbPA3Qe2.js";import{c as O}from"./constants-vpztXBkd.js";import{C as ne,a as re,d as ie}from"./card-CHroE5b1.js";import{D as v,a as f,b as N,c as D,d as S,e as b}from"./dialog-EypqIHoR.js";import{T as ce,a as de,b as $,c as le,d as oe,e as me}from"./table-D9DfdpbF.js";import{D as q,a as G,b as J,c as M,C as xe}from"./dropdown-menu-BJIcfCxy.js";import{S as _,a as P,b as k,c as F,d as T}from"./select-CVNnrmsb.js";import{u as ue,f as L,g as he}from"./index-D9zGBHrl.js";import{C as w}from"./credit-card-DbtKEXXO.js";import{C as A}from"./coins-DrjgZywA.js";import{P as pe}from"./plus-DfB9_f5F.js";import{c as Q}from"./createLucideIcon-DysgWwsB.js";import"./index-CxaUTmkl.js";import"./index-BRk-liT1.js";import"./index-DQmsG2na.js";import"./Combination-SYSJioZv.js";import"./index-BkidR4kz.js";import"./index-j9oXl22B.js";import"./index-BVknzT5Z.js";import"./index-CPWa_MGE.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ge=Q("ChevronLeft",je);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M5 12h14",key:"1ays0h"}]],Ce=Q("Minus",ye);function qe({customer:c,creditLogs:o}){const[U,u]=C.useState(!1),[W,h]=C.useState(!1),[X,p]=C.useState(!1),[Y,j]=C.useState(!1),{data:g,setData:y,post:B,processing:I,errors:d,reset:R}=V({amount:"",description:""}),{data:m,setData:x,post:K,processing:z,errors:t,reset:H}=V({amount:"",currency:"",description:""}),Z=s=>{s.preventDefault(),B(route("customers.credit.add",c),{onSuccess:()=>{u(!1),R()}})},ee=s=>{s.preventDefault(),B(route("customers.credit.deduct",c),{onSuccess:()=>{h(!1),R()}})},se=s=>{s.preventDefault(),K(route("customers.money.add",c),{onSuccess:()=>{p(!1),H()}})},te=s=>{s.preventDefault(),K(route("customers.money.deduct",c),{onSuccess:()=>{j(!1),H()}})},ae=[{header:"Date",accessorKey:"created_at",cell:({row:s})=>new Date(s.original.created_at).toLocaleString()},{header:"Type",accessorKey:"type",cell:({row:s})=>e.jsx(E,{variant:s.original.type==="add"?"success":"destructive",children:s.original.type==="add"?"Added":"Deducted"})},{header:"Category",accessorKey:"log_type",cell:({row:s})=>e.jsx(E,{variant:"outline",children:s.original.log_type==="credit"?"SMS Credit":"Money"})},{header:"Amount",accessorKey:"amount",cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:s.original.type==="add"?"text-green-600":"text-red-600",children:[s.original.type==="add"?"+":"-",Math.abs(s.original.amount)]}),s.original.currency&&e.jsx("span",{className:"text-muted-foreground text-sm",children:s.original.currency})]})},{header:"Description",accessorKey:"description"},{header:"Created By",accessorKey:"creator.name"}],r=ue({data:o.data,columns:ae,getCoreRowModel:he(),manualPagination:!0,pageCount:Math.ceil(o.total/o.per_page),state:{pagination:{pageIndex:o.current_page-1,pageSize:o.per_page}},onPaginationChange:s=>{if(typeof s=="function"){const i=s({pageIndex:o.current_page-1,pageSize:o.per_page});router.get(route("customers.show",c.id),{page:i.pageIndex+1,per_page:i.pageSize},{preserveState:!0,preserveScroll:!0})}}});return e.jsxs(e.Fragment,{children:[e.jsxs(ne,{children:[e.jsx(re,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-2xl font-semibold tracking-tight",children:"Credits & Balance"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["SMS Credits: ",c.sms_credit]})]}),c.rates.map(s=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[s.currency," Balance: ",s.balance]})]},s.id))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(q,{children:[e.jsx(G,{asChild:!0,children:e.jsxs(a,{variant:"outline",children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Add"]})}),e.jsxs(J,{align:"end",children:[e.jsxs(M,{onClick:()=>u(!0),children:[e.jsx(w,{className:"mr-2 h-4 w-4"}),"Add SMS Credit"]}),e.jsxs(M,{onClick:()=>p(!0),children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),"Add Money"]})]})]}),e.jsxs(q,{children:[e.jsx(G,{asChild:!0,children:e.jsxs(a,{variant:"outline",children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Deduct"]})}),e.jsxs(J,{align:"end",children:[e.jsxs(M,{onClick:()=>h(!0),children:[e.jsx(w,{className:"mr-2 h-4 w-4"}),"Deduct SMS Credit"]}),e.jsxs(M,{onClick:()=>j(!0),children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),"Deduct Money"]})]})]})]})]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"SMS Credit"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4"}),e.jsx("span",{className:"text-2xl font-bold",children:c.sms_credit})]})]}),c.rates.map(s=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{children:[s.currency," Balance"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("span",{className:"text-2xl font-bold",children:s.balance})]})]},s.id))]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(ce,{children:[e.jsx(de,{children:r.getHeaderGroups().map(s=>e.jsx($,{children:s.headers.map(i=>e.jsx(le,{children:L(i.column.columnDef.header,i.getContext())},i.id))},s.id))}),e.jsx(oe,{children:r.getRowModel().rows.map(s=>e.jsx($,{children:s.getVisibleCells().map(i=>e.jsx(me,{children:L(i.column.columnDef.cell,i.getContext())},i.id))},s.id))})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a,{variant:"outline",size:"sm",onClick:()=>r.previousPage(),disabled:!r.getCanPreviousPage(),children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx(a,{variant:"outline",size:"sm",onClick:()=>r.nextPage(),disabled:!r.getCanNextPage(),children:e.jsx(xe,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",r.getState().pagination.pageIndex+1," of"," ",r.getPageCount()]}),e.jsxs(_,{value:r.getState().pagination.pageSize.toString(),onValueChange:s=>{r.setPageSize(Number(s))},children:[e.jsx(P,{className:"h-8 w-[70px]",children:e.jsx(k,{})}),e.jsx(F,{children:[10,20,30,40,50].map(s=>e.jsx(T,{value:s.toString(),children:s},s))})]})]})]})]})})]}),e.jsx(v,{open:U,onOpenChange:u,children:e.jsxs(f,{children:[e.jsxs(N,{children:[e.jsx(D,{children:"Add SMS Credit"}),e.jsx(S,{children:"Add SMS credits to customer's account"})]}),e.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"amount",children:"Amount"}),e.jsx(l,{id:"amount",type:"number",min:"1",value:g.amount,onChange:s=>y("amount",s.target.value)}),d.amount&&e.jsx("p",{className:"text-sm text-destructive",children:d.amount})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(l,{id:"description",value:g.description,onChange:s=>y("description",s.target.value)}),d.description&&e.jsx("p",{className:"text-sm text-destructive",children:d.description})]}),e.jsxs(b,{children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>u(!1),children:"Cancel"}),e.jsx(a,{type:"submit",disabled:I,children:"Add Credit"})]})]})]})}),e.jsx(v,{open:W,onOpenChange:h,children:e.jsxs(f,{children:[e.jsxs(N,{children:[e.jsx(D,{children:"Deduct SMS Credit"}),e.jsx(S,{children:"Deduct SMS credits from customer's account"})]}),e.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"amount",children:"Amount"}),e.jsx(l,{id:"amount",type:"number",min:"1",value:g.amount,onChange:s=>y("amount",s.target.value)}),d.amount&&e.jsx("p",{className:"text-sm text-destructive",children:d.amount})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(l,{id:"description",value:g.description,onChange:s=>y("description",s.target.value)}),d.description&&e.jsx("p",{className:"text-sm text-destructive",children:d.description})]}),e.jsxs(b,{children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(a,{type:"submit",disabled:I,children:"Deduct Credit"})]})]})]})}),e.jsx(v,{open:X,onOpenChange:p,children:e.jsxs(f,{children:[e.jsxs(N,{children:[e.jsx(D,{children:"Add Money"}),e.jsx(S,{children:"Add money to customer's account"})]}),e.jsxs("form",{onSubmit:se,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"amount",children:"Amount"}),e.jsx(l,{id:"amount",type:"number",min:"0.01",step:"0.01",value:m.amount,onChange:s=>x("amount",s.target.value)}),t.amount&&e.jsx("p",{className:"text-sm text-destructive",children:t.amount})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"currency",children:"Currency"}),e.jsxs(_,{value:m.currency,onValueChange:s=>x("currency",s),children:[e.jsx(P,{children:e.jsx(k,{placeholder:"Select currency"})}),e.jsx(F,{children:O.map(s=>e.jsxs(T,{value:s.code,children:[s.name," (",s.code,")"]},s.code))})]}),t.currency&&e.jsx("p",{className:"text-sm text-destructive",children:t.currency})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(l,{id:"description",value:m.description,onChange:s=>x("description",s.target.value)}),t.description&&e.jsx("p",{className:"text-sm text-destructive",children:t.description})]}),e.jsxs(b,{children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(a,{type:"submit",disabled:z,children:"Add Money"})]})]})]})}),e.jsx(v,{open:Y,onOpenChange:j,children:e.jsxs(f,{children:[e.jsxs(N,{children:[e.jsx(D,{children:"Deduct Money"}),e.jsx(S,{children:"Deduct money from customer's account"})]}),e.jsxs("form",{onSubmit:te,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"amount",children:"Amount"}),e.jsx(l,{id:"amount",type:"number",min:"0.01",step:"0.01",value:m.amount,onChange:s=>x("amount",s.target.value)}),t.amount&&e.jsx("p",{className:"text-sm text-destructive",children:t.amount})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"currency",children:"Currency"}),e.jsxs(_,{value:m.currency,onValueChange:s=>x("currency",s),children:[e.jsx(P,{children:e.jsx(k,{placeholder:"Select currency"})}),e.jsx(F,{children:O.map(s=>e.jsxs(T,{value:s.code,children:[s.name," (",s.code,")"]},s.code))})]}),t.currency&&e.jsx("p",{className:"text-sm text-destructive",children:t.currency})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(l,{id:"description",value:m.description,onChange:s=>x("description",s.target.value)}),t.description&&e.jsx("p",{className:"text-sm text-destructive",children:t.description})]}),e.jsxs(b,{children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsx(a,{type:"submit",disabled:z,children:"Deduct Money"})]})]})]})})]})}export{qe as default};
