import{r as u,m as F,j as e}from"./App-CmqUjaN5.js";import{B as a}from"./button-P3a7UsiS.js";import{a as N,b as R,c as M,d as z}from"./card-W6xDAvb4.js";import{A as p,a as m}from"./alert-DRlNScyP.js";import{D as x,a as f,b as j,c as y,d as v,e as C}from"./dialog-dFOvoa_K.js";import{I}from"./input-BNaBDwi7.js";import{L}from"./label-BEB_8ICF.js";import{c as g}from"./createLucideIcon-DiUTaDX6.js";import"./index-8L4t-OO9.js";import"./index-CoAmXZ53.js";import"./Combination-DIdNSm4m.js";import"./index-cPx927kp.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],E=g("ShieldAlert",Q);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],O=g("ShieldCheck",H);function Z({user:o,className:w=""}){var h;const[n,r]=u.useState(!1),[i,c]=u.useState(!1),{data:b,setData:_,processing:l,post:s,reset:S,errors:d}=F({code:""}),k=()=>{s(route("two-factor.enable"),{preserveScroll:!0,onSuccess:()=>{r(!0),S()}})},A=t=>{t.preventDefault(),s(route("two-factor.confirm"),{preserveScroll:!0,onSuccess:()=>{r(!1),c(!0)}})},T=()=>{s(route("two-factor.recovery-codes"),{preserveScroll:!0})},D=()=>{s(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{r(!1),c(!1)}})};return e.jsxs("section",{className:w,children:[e.jsxs(N,{children:[e.jsx(R,{children:"Two Factor Authentication"}),e.jsx(M,{children:"Add additional security to your account using two factor authentication."})]}),e.jsxs(z,{className:"space-y-6",children:[!o.two_factor_enabled&&e.jsxs(e.Fragment,{children:[e.jsxs(p,{children:[e.jsx(E,{className:"size-4"}),e.jsx(m,{children:"When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application."})]}),e.jsx(a,{onClick:k,disabled:l,children:"Enable 2FA"})]}),o.two_factor_enabled&&e.jsxs(e.Fragment,{children:[e.jsxs(p,{children:[e.jsx(O,{className:"size-4"}),e.jsx(m,{children:"Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application."})]}),e.jsxs("div",{className:"space-y-4",children:[o.two_factor_qr_code&&n&&e.jsx(x,{open:n,onOpenChange:r,children:e.jsxs(f,{children:[e.jsxs(j,{children:[e.jsx(y,{children:"Setup Two Factor Authentication"}),e.jsx(v,{children:"To finish enabling two factor authentication, scan the following QR code using your phone's authenticator application or enter the setup key and provide the generated OTP code."})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:o.two_factor_qr_code}})}),e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"code",children:"Code"}),e.jsx(I,{id:"code",type:"text",inputMode:"numeric",value:b.code,onChange:t=>_("code",t.target.value),autoComplete:"one-time-code"}),d.code&&e.jsx("p",{className:"text-sm text-destructive",children:d.code})]}),e.jsxs(C,{children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(a,{type:"submit",disabled:l,children:"Confirm"})]})]})]})}),o.two_factor_recovery_codes&&i&&e.jsx(x,{open:i,onOpenChange:c,children:e.jsxs(f,{children:[e.jsxs(j,{children:[e.jsx(y,{children:"Two Factor Recovery Codes"}),e.jsx(v,{children:"Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost."})]}),e.jsx("div",{className:"mt-4 space-y-2",children:o.two_factor_recovery_codes.map(t=>e.jsx("div",{className:"font-mono text-sm",children:t},t))}),e.jsx(C,{children:e.jsx(a,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Close"})})]})}),e.jsxs("div",{className:"space-y-2",children:[((h=o.two_factor_recovery_codes)==null?void 0:h.length)>0&&e.jsx(a,{type:"button",variant:"outline",onClick:T,children:"Regenerate Recovery Codes"}),e.jsx(a,{type:"button",variant:"destructive",onClick:D,children:"Disable 2FA"})]})]})]})]})]})}export{Z as default};
